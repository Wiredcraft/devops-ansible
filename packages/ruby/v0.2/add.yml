---
- name: Ensure Ruby is installed
  apt: 
    pkg={{ item }}
    state=present
  with_items:
    - rubygems
  when:
    ansible_lsb.major_release|int < 14

- name: Ensure Ruby is installed
  apt: 
    pkg={{ item }}
    state=present
  with_items:
    - ruby
  when:
    ansible_lsb.major_release|int >= 14

- name: Ensure custom gem modules are installed
  gem:
    name={{ item }}
    state=present
    user_install=no
  with_items:
    ruby.gems
  ignore_errors: yes
