;;;;;;;;;;;;;;;;;;;;;;;;
; Generated by devo.ps ;
;;;;;;;;;;;;;;;;;;;;;;;;
; 
; The original file is available for reference at php-fpm.conf.orig

{# Define default variables if undefined #}
{% set php = php | default({}) %}
{% set fpm = php.fpm | default({}) %}
{% set pool = fpm.pool | default({}) %}
{% set bind = pool.bind | default({}) %}
{% set pm = pool.pm | default({}) %}
{% set ping = pool.ping | default({}) %}

[{{ pool.name | default('www') }}]

user = {{ pool.user | default('www-data') }}
group = {{ pool.group | default('www-data') }}

; Details about the listening port / sock
listen = {{ pool.listen | default('127.0.0.1:9000') }}
listen.owner = {{ bind.owner | default('www-data') }}
listen.group = {{ bind.group | default('www-data') }}
listen.mode = {{ bind.mode | default('0666') }}
{%if not bind.allowed_clients %};{% endif %}listen.allowed_clients = {{ bind.allowed_clients | default('127.0.0.1') }}

; Process manager settings
pm = {{ pm.type | default('static') }}
pm.max_children = {{ pm.max_children | default('10') }}
pm.start_servers = {{ pm.start_servers | default('4') }}
pm.min_spare_servers = {{ pm.min_spare_servers | default('2') }}
pm.max_spare_servers = {{ pm.max_spare_servers | default('6') }}
pm.process_idle_timeout = {{ pm.process_idle_timeout | default('10s') }}
pm.max_requests = {{ pm.process_idle_timeout | default('0') }}
pm.status_path = {{ pm.status_path | default('/status') }}

; Simple health status
{%if not ping.path %};{% endif %}ping.path = {{ ping.path | default('/ping') }}
{%if not ping.path %};{% endif %}ping.response = {{ ping.response | default('pong') }}

; Slow processes
slowlog = {{ pool.slowlog | default('/var/log/php-fpm/$pool.log.slow') }}
request_slowlog_timeout = {{ pool.request_slowlog_timeout | default('0') }}
request_terminate_timeout = {{ pool.request_terminate_timeout | default('0') }}

;
chdir = /

;;;;;;;;;;;
; devo.ps -- not supported - sorry guys
;;;;;;;;;;;
; The access log file
; Default: not set
;access.log = log/$pool.access.log

; The access log format.
; The following syntax is allowed
;  %%: the '%' character
;  %C: %CPU used by the request
;      it can accept the following format:
;      - %{user}C for user CPU only
;      - %{system}C for system CPU only
;      - %{total}C  for user + system CPU (default)
;  %d: time taken to serve the request
;      it can accept the following format:
;      - %{seconds}d (default)
;      - %{miliseconds}d
;      - %{mili}d
;      - %{microseconds}d
;      - %{micro}d
;  %e: an environment variable (same as $_ENV or $_SERVER)
;      it must be associated with embraces to specify the name of the env
;      variable. Some exemples:
;      - server specifics like: %{REQUEST_METHOD}e or %{SERVER_PROTOCOL}e
;      - HTTP headers like: %{HTTP_HOST}e or %{HTTP_USER_AGENT}e
;  %f: script filename
;  %l: content-length of the request (for POST request only)
;  %m: request method
;  %M: peak of memory allocated by PHP
;      it can accept the following format:
;      - %{bytes}M (default)
;      - %{kilobytes}M
;      - %{kilo}M
;      - %{megabytes}M
;      - %{mega}M
;  %n: pool name
;  %o: ouput header
;      it must be associated with embraces to specify the name of the header:
;      - %{Content-Type}o
;      - %{X-Powered-By}o
;      - %{Transfert-Encoding}o
;      - ....
;  %p: PID of the child that serviced the request
;  %P: PID of the parent of the child that serviced the request
;  %q: the query string 
;  %Q: the '?' character if query string exists
;  %r: the request URI (without the query string, see %q and %Q)
;  %R: remote IP address
;  %s: status (response code)
;  %t: server time the request was received
;      it can accept a strftime(3) format:
;      %d/%b/%Y:%H:%M:%S %z (default)
;  %T: time the log has been written (the request has finished)
;      it can accept a strftime(3) format:
;      %d/%b/%Y:%H:%M:%S %z (default)
;  %u: remote user
;
; Default: "%R - %u %t \"%m %r\" %s"
;access.format = %R - %u %t "%m %r%Q%q" %s %f %{mili}d %{kilo}M %C%%
