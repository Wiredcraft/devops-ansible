#
# Generated by devo.ps for {{ ansible_hostname }}
#
{# Define default variables if undefined #}
{% set mongodb = mongodb | default({}) %}
description "MongoDB"

start on runlevel [2345]
stop on runlevel [!2345]

pre-start script
    mkdir -p {{ mongodb.dbpath }}
    mkdir -p {{ mongodb.logpath | dirname }}
end script

script
    ENABLE_MONGODB="yes"
    if [ -f /etc/default/mongodb ]; then
        . /etc/default/mongodb
    fi
    if [ "x$ENABLE_MONGODB" = "xyes" ]; then
        exec start-stop-daemon --start --quiet --chuid {{ mongodb.user }} \
            --exec /usr/bin/mongod -- {% if mongodb.enable_rest %}--rest{% endif %} --config /etc/mongodb.conf
    fi
end script
